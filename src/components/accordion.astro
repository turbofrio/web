---
import type { HTMLAttributes } from "astro/types"
import PlusIcon from "@icons/plus.svg"
import MinusIcon from "@icons/minus.svg"

type Props = HTMLAttributes<"details"> & {
  class?: string
  variant?: "primary" | "secondary"
}

const { class: className, variant = "primary", ...rest } = Astro.props
---

<details class:list={[variant, className]} {...rest}>
  <summary>
    <span>
      <slot name="icon" />
    </span>

    <slot name="title" />

    <PlusIcon class="plus-icon" aria-hidden />
    <MinusIcon class="minus-icon" aria-hidden />
  </summary>

  <div>
    <slot name="content" />
  </div>
</details>

<style>
  details {
    cursor: pointer;
    border-radius: 12px;
  }

  details[open] {
    color: var(--gray-500);
  }

  details[open] > summary {
    color: var(--sky-600);
    padding-bottom: 16px;
  }

  summary {
    display: flex;
    list-style: none;
  }

  summary > span {
    display: none;
  }

  .primary {
    background-color: color-mix(in lab, white 10%, transparent);
    backdrop-filter: blur(6px);
    overflow: hidden;

    border: solid 1px color-mix(in lab, white 5%, transparent);
    max-width: 688px;
  }

  .primary[open] {
    background-color: color-mix(in lab, white 90%, transparent);
    box-shadow: 0 4px 4px color-mix(in lab, black 15%, transparent);
  }

  .primary > summary {
    font-size: 1.125rem;
    font-weight: 700;

    align-items: center;
    padding: 20px 20px 20px 16px;
  }

  .primary span {
    display: inline;
    margin-right: 36px;
  }

  .primary[open] span {
    color: var(--sky-500);
  }

  .primary > div {
    overflow: hidden;
    padding: 0px 20px 20px 84px;
  }

  .minus-icon,
  .plus-icon {
    display: none;
    flex-shrink: 0;
    margin-left: 20px;
  }

  .secondary:not([open]) .plus-icon {
    display: block;
  }

  .secondary[open] .minus-icon {
    display: block;
  }

  .secondary[open] {
    background-color: white;
    border: solid 1px var(--gray-200);
    box-shadow: 0 1px 2px color-mix(in lab, black 15%, transparent);
  }

  .secondary > summary {
    align-items: center;
    justify-content: space-between;
    padding: 16px 20px;

    color: var(--gray-800);
    font-weight: 600;
  }

  .secondary > div {
    font-size: 1rem;
    font-weight: 500;
    line-height: 1.5;
    padding: 0 20px 16px 20px;
  }
</style>
