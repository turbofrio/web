---
import WhatsappIcon from "@icons/whatsapp-logo.svg"
import Button from "./button.astro"
import Card from "./card/card.astro"
import CardContent from "./card/card-content.astro"
import CardRating from "./card/card-rating.astro"
import CardAuthor from "./card/card-author.astro"
import pauloAvatar from "@images/paulo-vital-avatar.png"
import lucasAvatar from "@images/lucas-barros-avatar.png"
import edMendoncaAvatar from "@images/ed-mendonca-avatar.png"
import felipeBotelhoAvatar from "@images/felipe-botelho-avatar.png"
import jaineFalcaoAvatar from "@images/jaine-falcao-avatar.png"
import luizaBrandaoAvatar from "@images/luiza-brandao-avatar.png"
import mairllyLustozaAvatar from "@images/mairlly-lustoza-avatar.png"
import { formatMessageForWhatsApp } from "@/utils/format-message-for-whatsapp"

const reviews: {
  review: string
  author: string
  date: string
  image: string
}[] = [
  {
    review: `Melhor empresa de climatiza√ß√£o em Macei√≥ e regi√µes, atenderam
              totalmente as minhas expectativas. Pontualidade, √≥timo
              atendimento. Confio de olhos fechados!!!`,
    author: "Luana Beatriz",
    date: "2025-01-01",
    image: "",
  },
  {
    review: `Empresa correta, servi√ßo de extrema qualidade, atendimento antes,
              durante e ap√≥s o servi√ßo muito bom, t√©cnicos qualificados e
              educados, indico a todos sem d√∫vidas.`,
    author: "Jo√£o Sarmento",
    date: "2024-11-01",
    image: "",
  },
  {
    review: `Excelente atendimento e profissionalismo! A equipe √© altamente
              qualificada, pontual e atenciosa. Os servi√ßos de climatiza√ß√£o
              foram realizados com perfei√ß√£o, garantindo conforto e efici√™ncia.
              Recomendo de olhos fechados para quem busca qualidade e confian√ßa!`,
    author: "Paulo Vital",
    date: "2025-05-15",
    image: pauloAvatar.src,
  },
  {
    review: `Excelente! Equipe profissional e especializada, maquin√°rio de
              √∫ltima gera√ß√£o! Super indico!`,
    author: "Lucas Barros",
    date: "2023-05-15",
    image: lucasAvatar.src,
  },
  {
    review: `Experi√™ncia muito boa. Atendimento, disponibilidade, execu√ß√£o do servi√ßo 
              e explica√ß√£o de todo o procedimento. S√≥ agradecer pela qualidade üëèüèªüëäüèª`,
    author: "Felipe Botelho",
    date: "2025-06-04",
    image: felipeBotelhoAvatar.src,
  },
  {
    review: `Profissionais respons√°veis e pre√ßo justo.`,
    author: "Mairlly Lustoza",
    date: "2025-06-04",
    image: mairllyLustozaAvatar.src,
  },
  {
    review: `Empresa maravilhosa, colaboradores pontuais, √©ticos e com valores.`,
    author: "Lany Tatajuba",
    date: "2025-01-04",
    image: "",
  },
  {
    review: `Apesar de ter ficado chateada com o atendimento demorado inicialmente, 
              fizeram um trabalho √≥timo e foram muito profissionais.`,
    author: "Luiza Brand√£o",
    date: "2024-07-04",
    image: luizaBrandaoAvatar.src,
  },
  {
    review: `√ìtimo profissionais`,
    author: "Ed Mendonca",
    date: "2025-06-04",
    image: edMendoncaAvatar.src,
  },
  {
    review: `√ìtimos profissionais, excelente atendimento. Super indico!!!!`,
    author: "Jaine Falc√£o",
    date: "2023-07-04",
    image: jaineFalcaoAvatar.src,
  },
]
---

<section>
  <div class="container">
    <h2>
      O que os <strong>nossos<br class="line-break" /> clientes</strong> dizem
    </h2>
  </div>

  <div class="reviews-wrapper">
    <div class="scroller">
      <div class="reviews">
        {
          reviews.map(({ author, date, image, review }, i) => (
            <Card variant="secondary">
              <CardContent>
                <p>{review}</p>
              </CardContent>

              <CardRating />

              <CardAuthor author={author} avatar={image} date={date} />
            </Card>
          ))
        }

        <script>
          import { getRandomNumbers } from "@utils/get-random-numbers"

          const cards = document.querySelectorAll(".reviews > .secondary")
          const setOfRandomNumbers = getRandomNumbers(4, 0, 9)

          cards.forEach((card, index) => {
            setOfRandomNumbers.has(index)
              ? card.classList.remove("hidden")
              : card.classList.add("hidden")
          })
        </script>
      </div>
    </div>
  </div>

  <div class="container">
    <Button
      as="a"
      href={formatMessageForWhatsApp("+55 (82) 99812-8254", "Ola, equipe!")}
    >
      <WhatsappIcon aria-hidden />
      Fale conosco
    </Button>
  </div>
</section>

<style>
  section {
    background-color: var(--sky-50);
    padding-block: 80px;
  }

  .container {
    display: flex;
    flex-direction: column;
    padding-inline: 16px;
  }

  h2 {
    text-align: center;
    line-height: 1.2;
  }

  strong {
    color: var(--sky-600);
    font-weight: 600;
  }

  .reviews-wrapper {
    overflow-x: auto;
  }

  .scroller {
    margin-inline: auto;
    width: max-content;
  }

  .reviews {
    display: flex;
    gap: 16px;
    margin: 55px 16px;
  }

  .content {
    margin-bottom: 0;
  }

  @media (min-width: 1024px) {
    a {
      align-self: center;
    }
  }

  @media (min-width: 1280px) {
    .reviews {
      gap: 55px;
    }
  }
</style>
